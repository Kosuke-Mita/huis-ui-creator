(function(n){"use strict";function s(n){n.scripts&&n.scripts.length>0&&importScripts.apply(undefined,n.scripts);postMessage({type:"importScripts"})}function e(i){var f=n[i.codecClass],u=i.sn;if(t[u])throw Error("duplicated sn");t[u]={codec:new f(i.options),crcInput:i.crcType==="input",crcOutput:i.crcType==="output",crc:new r};postMessage({type:"newTask",sn:u})}function o(n){var f=n.sn,l=n.type,h=n.data,r=t[f],c,o,u,a;if(!r&&n.codecClass&&(e(n),r=t[f]),c=l==="append",o=i(),c)try{u=r.codec.append(h,function(n){postMessage({type:"progress",sn:f,loaded:n})})}catch(y){delete t[f];throw y;}else delete t[f],u=r.codec.flush();a=i()-o;o=i();h&&r.crcInput&&r.crc.append(h);u&&r.crcOutput&&r.crc.append(u);var p=i()-o,s={type:l,sn:f,codecTime:a,crcTime:p},v=[];u&&(s.data=u,v.push(u.buffer));!c&&(r.crcInput||r.crcOutput)&&(s.crc=r.crc.get());try{postMessage(s,v)}catch(b){postMessage(s)}}function h(n,t,i){var r={type:n,sn:t,error:c(i)};postMessage(r)}function c(n){return{message:n.message,stack:n.stack}}function r(){this.crc=-1}function u(){}var f,t,i;if(n.zWorkerInitialized)throw new Error("z-worker.js should be run only once");n.zWorkerInitialized=!0;addEventListener("message",function(n){var t=n.data,i=t.type,u=t.sn,r=f[i];if(r)try{r(t)}catch(e){h(i,u,e)}});f={importScripts:s,newTask:e,append:o,flush:o};t={};i=n.performance?n.performance.now.bind(n.performance):Date.now;r.prototype.append=function(n){for(var t=this.crc|0,r=this.table,i=0,u=n.length|0;i<u;i++)t=t>>>8^r[(t^n[i])&255];this.crc=t};r.prototype.get=function(){return~this.crc};r.prototype.table=function(){for(var i,n,r=[],t=0;t<256;t++){for(n=t,i=0;i<8;i++)n=n&1?n>>>1^3988292384:n>>>1;r[t]=n}return r}();n.NOOP=u;u.prototype.append=function(n){return n};u.prototype.flush=function(){}})(this);
